regions:
  - eu-west-1
stacks:
  - workflow
deployments:
  pinboard-cloudformation:
    type: cloud-formation
    app: pinboard
    parameters:
      cloudFormationStackByTags: false
      prependStackToCloudFormationStackName: false
      cloudFormationStackName: pinboard
      templatePath: cloudformation.yaml

  pinboard-bootstrapping-lambda-api:
    dependencies:
      - pinboard-cloudformation
      - pinboard-workflow-bridge-lambda
      - pinboard-grid-bridge-lambda
      - pinboard-users-refresher-lambda
      - pinboard-notifications-lambda
      - pinboard-auth-lambda
      - pinboard-user-salt-rotation-lambda
    type: aws-lambda
    parameters:
      prefixStack: false
      bucket: workflow-dist
      fileName: pinboard-bootstrapping-lambda-api.zip
      functionNames: [pinboard-bootstrapping-lambda-]

  pinboard-workflow-bridge-lambda:
    dependencies:
      - pinboard-cloudformation
    type: aws-lambda
    parameters:
      prefixStack: false
      bucket: workflow-dist
      fileName: pinboard-workflow-bridge-lambda.zip
      functionNames: [pinboard-workflow-bridge-lambda-]

  pinboard-grid-bridge-lambda:
    dependencies:
      - pinboard-cloudformation
    type: aws-lambda
    parameters:
      prefixStack: false
      bucket: workflow-dist
      fileName: pinboard-grid-bridge-lambda.zip
      functionNames: [pinboard-grid-bridge-lambda-]

  pinboard-users-refresher-lambda:
    dependencies:
      - pinboard-cloudformation
    type: aws-lambda
    parameters:
      prefixStack: false
      bucket: workflow-dist
      fileName: pinboard-users-refresher-lambda.zip
      functionNames: [pinboard-users-refresher-lambda-]

  pinboard-notifications-lambda:
    dependencies:
      - pinboard-cloudformation
    type: aws-lambda
    parameters:
      prefixStack: false
      bucket: workflow-dist
      fileName: pinboard-notifications-lambda.zip
      functionNames: [pinboard-notifications-lambda-]

  pinboard-auth-lambda:
    dependencies:
      - pinboard-cloudformation
    type: aws-lambda
    parameters:
      prefixStack: false
      bucket: workflow-dist
      fileName: pinboard-auth-lambda.zip
      functionNames: [pinboard-auth-lambda-]

  pinboard-user-salt-rotation-lambda:
    dependencies:
      - pinboard-cloudformation
    type: aws-lambda
    parameters:
      prefixStack: false
      bucket: workflow-dist
      fileName: pinboard-user-salt-rotation-lambda.zip
      functionNames: [pinboard-user-salt-rotation-lambda-]
